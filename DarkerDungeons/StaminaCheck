!@{selected|wtype}&{template:default}{{name=Stamina Check: @{selected|character_name}}}{& define ([DCVal] [[({@{selected|condition_hunger},@{selected|condition_thirst},@{selected|condition_fatigue},@{selected|condition_temperature}}kl1)*5]]) ([SaveRoll] [[?{Roll stamina check with advantage?|None,1d20|Advantage,2d20kh1 (advantage)|Disadvantage,2d20kl1 (disadvantage)}+@{selected|constitution_save_bonus}]]) ([PenaltyRoll] [[1d3]])}{{DC=DCVal}}{{Con Save (?{Roll stamina check with advantage?}+@{selected|constitution_save_bonus})=SaveRoll}}{& if SaveRoll < DCVal}{{Outcome=Failed}}{& if PenaltyRoll = 1 && @{selected|condition_hunger} < 6}{{Penalty=Hunger}}%NEWLINE%!modattr --charid @{selected|character_id} --condition_hunger|1{& elseif PenaltyRoll = 2 && @{selected|condition_thirst} < 6}{{Penalty=Thirst}}%NEWLINE%!modattr --charid @{selected|character_id} --condition_thirst|1{& elseif PenaltyRoll = 3 && @{selected|condition_fatigue} < 6}{{Penalty=Fatigue}}%NEWLINE%!modattr --charid @{selected|character_id} --condition_fatigue|1{& else}{{Penalty Roll={& if PenaltyRoll = 1}You're still starving! (Max Hunger){& elseif PenaltyRoll = 2}You're still dehydrated! (Max Thirst){& elseif PenaltyRoll = 3}You're still barely awake! (Max Fatigue){&end}}}{& end}{& else}{{Outcome=Success}}{&end}{&simple}